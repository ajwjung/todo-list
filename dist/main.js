(()=>{"use strict";const e=(()=>{const e=e=>(e=>/\-/g.test(e))(e)?e.replace(/\-/g," "):e,t=e=>e.toLowerCase().split(" ").map((e=>e.charAt(0).toUpperCase()+e.substring(1))).join(" ");return{replaceHyphensWithSpaces:e,getHyphenatedName:e=>(e=>/\s/g.test(e))(e)?e.replace(/\s+/g,"-"):e,capitalizeFirstLetters:t,makeNamePresentable:a=>{const s=e(a);return t(s)}}})(),t=(()=>{const e=()=>JSON.parse(localStorage.getItem("allCategories"));return{setCategories:()=>{localStorage.setItem("allCategories",JSON.stringify(["default"]))},getCategories:e,pushCategory:t=>{const a=e();var s;a.push(t),s=a,localStorage.setItem("allCategories",JSON.stringify(s))}}})(),a=(()=>{const t=()=>JSON.parse(localStorage.getItem("allTasks")),a=e=>{localStorage.setItem("allTasks",JSON.stringify(e)),console.log(t())};return{setTasks:()=>{localStorage.setItem("allTasks",JSON.stringify({default:[]}))},getTasks:t,pushTask:e=>{const r=t();let o;"new task"==e?o=n.TodoTask("new task"):"edit task"==e&&(o=n.TodoTask("edit task"),s.setUpdatedTaskVariable(o)),r[o.category].push(o),a(r)},removeTask:(e,s)=>{const n=t();n[e]=s,a(n)},updateTaskArr:a,addCategoryToObject:s=>{const n=t();n[e.getHyphenatedName(s)]=[],a(n)}}})(),s=(()=>{let s,n=!1;return{checkNewCategoryAdded:a=>{const s=e.getHyphenatedName(a).toLowerCase();return t.getCategories().includes(s)||(n=!0),n},resetCategoryAdded:()=>{n=!1},pushNewCategory:a=>{t.pushCategory(e.getHyphenatedName(a))},checkTaskHasCategory:e=>a.getTasks().hasOwnProperty(e),setUpdatedTaskVariable:e=>{s=e},getUpdatedTask:()=>s,getRelevantTasks:e=>a.getTasks()[e]}})(),n=(()=>{const e=()=>document.querySelector("input[name='categoryName']").value,t=e=>{let t,a,s,n,r,o;return"new task"==e?(t=document.getElementById("task-title").value,a=document.getElementById("task-description").value,s=document.getElementById("task-notes").value,n=document.getElementById("task-due-date").value,r=document.getElementById("priority-level").value,o=document.getElementById("task-category").value):"edit task"==e&&(t=document.getElementById("edit-task-title").value,a=document.getElementById("edit-task-description").value,s=document.getElementById("edit-task-notes").value,n=document.getElementById("edit-task-due-date").value,r=document.getElementById("edit-priority-level").value,o=document.getElementById("edit-task-category").value),{title:t,description:a,notes:s,dueDate:n,priority:r,category:o}};return{getCategoryName:e,newCategoryHandler:()=>{const t=e();s.checkTaskHasCategory(t)||a.addCategoryToObject(t),s.pushNewCategory(t)},TodoTask:t,getTaskObject:e=>t(e),newTaskHandler:()=>{a.pushTask("new task")}}})(),r=(()=>{const a=t=>{const a=document.createElement("div");return a.setAttribute("id",t),a.classList.add("category"),a.textContent=e.makeNamePresentable(t),a};return{getNewCategory:()=>{const e=t.getCategories();return e[e.length-1]},createCategoryDiv:a,appendCategoryDiv:e=>{const t=document.querySelector(".expanded-sidebar"),s=a(e);t.insertBefore(s,t.lastElementChild)}}})(),o=(()=>{const t=document.querySelector(".display-container");return{addExistingOptions:t=>{const a=document.getElementById("task-category"),s=document.getElementById("edit-task-category");a.add(new Option(e.makeNamePresentable(t),t)),s.add(new Option(e.makeNamePresentable(t),t))},addNewOptionToSelect:t=>{const a=document.getElementById("task-category"),s=document.getElementById("edit-task-category"),n=r.getNewCategory(t);a.add(new Option(e.makeNamePresentable(n),n)),s.add(new Option(e.makeNamePresentable(n),n))},clearContents:()=>{t.innerHTML=""},createDiv:(e,t)=>{const a=document.createElement("div");return a.classList.add(e),t&&a.classList.add(t),a},createPara:(e,t)=>{const a=document.createElement("p");return a.classList.add(e),a.textContent=t,a},createCategoryH1:t=>{const a=document.createElement("h1");return a.setAttribute("id","category-name"),a.textContent=e.makeNamePresentable(t),a},appendH1:e=>{t.appendChild(e)},createViewBtn:()=>{const e=document.createElement("button");return e.setAttribute("type","button"),e.classList.add("view-details"),e.classList.add("filter-pink"),e},createEditBtn:()=>{const e=document.createElement("button");return e.setAttribute("type","button"),e.classList.add("edit-details"),e.classList.add("filter-pink"),e},createDeleteBtn:()=>{const e=document.createElement("button");return e.setAttribute("type","button"),e.classList.add("delete-task"),e.classList.add("filter-pink"),e},expandCollapseTabs:(e,t)=>{const a=document.querySelector(e),s=document.querySelector(t);a.addEventListener("click",(function(e){s.classList.toggle("hidden")}))}}})(),d=(()=>{const e=document.querySelector(".display-container"),t=document.querySelector(".backdrop"),n=document.getElementById("close-popup"),r=document.getElementById("edit-task-form");let o,d,i=!1;const u=()=>o,p=()=>{t.classList.add("hidden")},m=()=>d;return{getCurrentDiv:u,getCurrentTask:m,getTaskStatus:()=>i,editTaskHandler:()=>{e.addEventListener("click",(function(e){e.target.classList.contains("edit-details")&&(t.classList.remove("hidden"),(e=>{const t=c.getDivDescription(e.target.parentNode),a=g.getTabName();let n=s.getRelevantTasks(a);for(let e=0;e<n.length;e++)n[e].description==t&&(d=n[e])})(e),(e=>{o=e.target.parentNode})(e),(()=>{const e=m();console.log(e);const t=document.getElementById("edit-task-title"),a=document.getElementById("edit-task-description"),s=document.getElementById("edit-task-notes"),n=document.getElementById("edit-task-due-date"),r=document.getElementById("edit-priority-level"),o=document.getElementById("edit-task-category");t.setAttribute("value",e.title),a.setAttribute("value",e.description),s.value=e.notes,n.setAttribute("value",e.dueDate),r.value=e.priority,o.value=e.category})(),i=!1)})),n.addEventListener("click",(function(e){p()})),r.addEventListener("submit",(function(e){e.preventDefault(),(()=>{const e=m(),t=e.category;l.deleteObjectHandler(s.getRelevantTasks(t),e.description,t),a.pushTask("edit task")})(),r.reset(),p(),(()=>{const e=s.getUpdatedTask(),t=u();if(e.category==g.getTabName()){t.querySelector(".title").textContent=e.title,t.querySelector(".description").textContent=e.description,t.querySelector(".task-date").textContent=e.dueDate;const a=t.querySelector(".priority-indicator").classList;a.remove("low","medium","high"),a.add(e.priority)}else l.deleteTaskCard(t.parentNode,t)})(),i=!0}))}}})(),i=(()=>{const e=e=>{const t=document.querySelector(".display-container"),a=(e=>{const t=o.createDiv("task-container"),a=(e=>{const t=o.createDiv("task-overview","strikethrough"),a=o.createDiv("priority-indicator",e.priority),s=o.createDiv("checkbox","unchecked"),n=o.createPara("title",e.title),r=o.createPara("description",e.description),d=o.createPara("task-date",e.dueDate),i=o.createViewBtn(),c=o.createEditBtn(),l=o.createDeleteBtn();return t.appendChild(a),t.appendChild(s),t.appendChild(n),t.appendChild(r),t.appendChild(d),t.appendChild(i),t.appendChild(c),t.appendChild(l),t})(e);return t.appendChild(a),t})(e),s=a.querySelector(".view-details"),n=a.querySelector(".checkbox");var r;(r=n).addEventListener("click",(function(e){r.parentNode.classList.toggle("strikethrough"),r.classList.toggle("unchecked")})),c.expandDiv(s,a,e),t.appendChild(a)};return{createTaskDetails:e=>{const t=o.createDiv("task-details"),a=o.createPara("task-notes",e.notes);return t.appendChild(a),t},toggleViewDetails:e=>{e.classList.toggle("hide-details")},appendTaskDiv:e,createAllTaskDivs:()=>{const t=g.getTabName();s.getRelevantTasks(t).forEach((t=>{e(t)}))}}})(),c=(()=>{let e={};const t=e=>e.querySelector(".description").textContent,a=a=>e.hasOwnProperty(t(a)),n=a=>e[t(a)],r=a=>{e[t(a)]=!0},o=(e,t)=>{const a=i.createTaskDetails(t);e.appendChild(a)};return{getDivDescription:t,expandDiv:(c,l,g)=>{c.addEventListener("click",(function(u){i.toggleViewDetails(c),((d,i,c)=>{a(d)?a(d)&&n(d)?(d.classList.toggle("expand-task"),(e=>{e.removeChild(e.lastElementChild)})(d),e[t(d)]=!1):a(d)&&!n(d)&&(d.classList.toggle("expand-task"),o(d,c?s.getUpdatedTask():i),r(d)):(d.classList.toggle("expand-task"),o(d,c?s.getUpdatedTask():i),r(d))})(l,g,d.getTaskStatus())}))}}})(),l=(()=>{const t=document.querySelector(".display-container"),n=(e,t,s)=>{const n=e.filter((e=>e.description!==t));a.removeTask(s,n)},r=(e,t)=>{e.removeChild(t)};return{deleteObjectHandler:n,deleteTaskCard:r,removeTaskHandler:()=>{t.addEventListener("click",(function(a){a.target.classList.contains("delete-task")&&(r(t,a.target.parentNode.parentNode),(a=>{const r=c.getDivDescription(a.target.parentNode),o=t.firstElementChild.textContent,d=e.getHyphenatedName(o.toLowerCase());let i=s.getRelevantTasks(d);n(i,r,d)})(a))}))}}})(),g=(()=>{const e=()=>localStorage.getItem("currentCategory"),t=e=>{e.classList.add("active-div")},a=()=>{document.querySelectorAll(".category").forEach((e=>{e.classList.remove("active-div")}))};return{setInitialCategory:()=>{localStorage.setItem("currentCategory","default")},getTabName:e,resetActiveDiv:a,setThisDivActive:t,tabHandler:()=>{document.querySelector(".expanded-sidebar").addEventListener("click",(function(s){if(s.target.classList.contains("category")){a(),t(s.target),n=s.target.id,localStorage.setItem("currentCategory",n),o.clearContents();const r=o.createCategoryH1(e());o.appendH1(r),i.createAllTaskDivs()}var n}))}}})(),u=(()=>{const e=()=>{const e=document.getElementById("default");g.setThisDivActive(e)};return{setDefault:()=>{t.getCategories()&&a.getTasks()||(t.setCategories(),a.setTasks(),g.setInitialCategory(),e())},loadCategories:()=>{const e=t.getCategories();if(e&&e.length>1){for(let t=1;t<e.length;t++)r.appendCategoryDiv(e[t]),o.addExistingOptions(e[t]);(()=>{g.resetActiveDiv();const e=document.getElementById(g.getTabName());g.setThisDivActive(e)})()}},addNewCategory:()=>{const e=document.querySelector("#projects-form");e.addEventListener("submit",(function(t){t.preventDefault(),s.checkNewCategoryAdded(n.getCategoryName())&&(n.newCategoryHandler(),r.appendCategoryDiv(r.getNewCategory()),o.addNewOptionToSelect(r.getNewCategory()),e.reset(),s.resetCategoryAdded())}))},addNewTask:()=>{const e=document.querySelector("#task-form");e.addEventListener("submit",(function(t){t.preventDefault(),n.newTaskHandler(t);const a=g.getTabName(),s=n.getTaskObject("new task");s.category==a&&i.appendTaskDiv(s),e.reset()}))},setDefaultActive:e}})();(()=>{document.querySelector("#task-due-date").min=(new Date).toISOString().split("T")[0],u.setDefault(),u.loadCategories(),o.expandCollapseTabs(".sidebar",".expanded-sidebar"),o.expandCollapseTabs("#add-new-task",".task-form-container");const e=o.createCategoryH1(g.getTabName());o.appendH1(e),u.addNewCategory(),u.addNewTask(),g.tabHandler(),l.removeTaskHandler(),d.editTaskHandler()})()})();