(()=>{"use strict";const e=(()=>{const e=e=>(e=>/\-/g.test(e))(e)?e.replace(/\-/g," "):e,t=e=>e.toLowerCase().split(" ").map((e=>e.charAt(0).toUpperCase()+e.substring(1))).join(" ");return{replaceHyphensWithSpaces:e,getHyphenatedName:e=>(e=>/\s/g.test(e))(e)?e.replace(/\s+/g,"-"):e,capitalizeFirstLetters:t,makeNamePresentable:a=>{const n=e(a);return t(n)}}})(),t=(()=>{const e=()=>JSON.parse(localStorage.getItem("allCategories"));return{setCategories:()=>{localStorage.setItem("allCategories",JSON.stringify(["default"]))},getCategories:e,pushCategory:t=>{const a=e();var n;a.push(t),n=a,localStorage.setItem("allCategories",JSON.stringify(n))}}})(),a=(()=>{const t=()=>JSON.parse(localStorage.getItem("allTasks")),a=e=>{localStorage.setItem("allTasks",JSON.stringify(e)),console.log(t())};return{setTasks:()=>{localStorage.setItem("allTasks",JSON.stringify({default:[]}))},getTasks:t,pushTask:e=>{const r=t();let d;"new task"==e?d=s.TodoTask("new task"):"edit task"==e&&(d=s.TodoTask("edit task"),n.updateTaskVariable(d)),r[d.category].push(d),a(r)},addCategoryToObject:n=>{const s=t();s[e.getHyphenatedName(n)]=[],a(s)}}})(),n=(()=>{let n,s=t.getCategories(),r=a.getTasks(),d=!1;return{checkNewCategoryAdded:t=>{const a=e.getHyphenatedName(t).toLowerCase();return s.includes(a)||(d=!0),d},resetCategoryAdded:()=>{d=!1},pushNewCategory:a=>{t.pushCategory(e.getHyphenatedName(a))},checkTaskHasCategory:e=>r.hasOwnProperty(e),updateTaskVariable:e=>{n=e},updateArr:(e,t)=>{r[e]=t,console.log(r)},getUpdatedTask:()=>n,getRelevantTasks:e=>r[e],allCategories:s,allTasks:r}})(),s=(()=>{const e=()=>document.querySelector("input[name='categoryName']").value,t=e=>{let t,a,n,s,r,d;return"new task"==e?(t=document.getElementById("task-title").value,a=document.getElementById("task-description").value,n=document.getElementById("task-notes").value,s=document.getElementById("task-due-date").value,r=document.getElementById("priority-level").value,d=document.getElementById("task-category").value):"edit task"==e&&(t=document.getElementById("edit-task-title").value,a=document.getElementById("edit-task-description").value,n=document.getElementById("edit-task-notes").value,s=document.getElementById("edit-task-due-date").value,r=document.getElementById("edit-priority-level").value,d=document.getElementById("edit-task-category").value),{title:t,description:a,notes:n,dueDate:s,priority:r,category:d}};return{getCategoryName:e,newCategoryHandler:()=>{const t=e();n.checkTaskHasCategory(t)||a.addCategoryToObject(t),n.pushNewCategory(t)},TodoTask:t,getTaskObject:e=>t(e),newTaskHandler:()=>{a.pushTask("new task")}}})(),r=(()=>{const a=t=>{const a=document.createElement("div");return a.setAttribute("id",t),a.classList.add("category"),a.textContent=e.makeNamePresentable(t),a};return{getNewCategory:()=>{const e=t.getCategories();return e[e.length-1]},createCategoryDiv:a,appendCategoryDiv:e=>{const t=document.querySelector(".expanded-sidebar"),n=a(e);t.insertBefore(n,t.lastElementChild)}}})(),d=(()=>{const t=document.querySelector(".display-container");return{addExistingOptions:t=>{const a=document.getElementById("task-category"),n=document.getElementById("edit-task-category");a.add(new Option(e.makeNamePresentable(t),t)),n.add(new Option(e.makeNamePresentable(t),t))},addNewOptionToSelect:t=>{const a=document.getElementById("task-category"),n=document.getElementById("edit-task-category"),s=r.getNewCategory(t);a.add(new Option(e.makeNamePresentable(s),s)),n.add(new Option(e.makeNamePresentable(s),s))},clearContents:()=>{t.innerHTML=""},createDiv:(e,t)=>{const a=document.createElement("div");return a.classList.add(e),t&&a.classList.add(t),a},createPara:(e,t)=>{const a=document.createElement("p");return a.classList.add(e),a.textContent=t,a},createCategoryH1:t=>{const a=document.createElement("h1");return a.setAttribute("id","category-name"),a.textContent=e.makeNamePresentable(t),a},appendH1:e=>{t.appendChild(e)},createViewBtn:()=>{const e=document.createElement("button");return e.setAttribute("type","button"),e.classList.add("view-details"),e.classList.add("filter-pink"),e},createEditBtn:()=>{const e=document.createElement("button");return e.setAttribute("type","button"),e.classList.add("edit-details"),e.classList.add("filter-pink"),e},createDeleteBtn:()=>{const e=document.createElement("button");return e.setAttribute("type","button"),e.classList.add("delete-task"),e.classList.add("filter-pink"),e},expandCollapseTabs:(e,t)=>{const a=document.querySelector(e),n=document.querySelector(t);a.addEventListener("click",(function(e){n.classList.toggle("hidden")}))}}})(),o=(()=>{const e=document.querySelector(".display-container"),t=document.querySelector(".backdrop"),s=document.getElementById("close-popup"),r=document.getElementById("edit-task-form");let d,o,i=!1;const g=()=>d,p=()=>{t.classList.add("hidden")},m=()=>o;return{getCurrentDiv:g,getCurrentTask:m,getTaskStatus:()=>i,editTaskHandler:()=>{e.addEventListener("click",(function(e){e.target.classList.contains("edit-details")&&(t.classList.remove("hidden"),(e=>{const t=c.getDivDescription(e.target.parentNode),a=u.getTabName();let s=n.getRelevantTasks(a);for(let e=0;e<s.length;e++)s[e].description==t&&(o=s[e])})(e),(e=>{d=e.target.parentNode})(e),(()=>{const e=m(),t=document.getElementById("edit-task-title"),a=document.getElementById("edit-task-description"),n=document.getElementById("edit-task-notes"),s=document.getElementById("edit-task-due-date"),r=document.getElementById("edit-priority-level"),d=document.getElementById("edit-task-category");t.setAttribute("value",e.title),a.setAttribute("value",e.description),n.value=e.notes,s.setAttribute("value",e.dueDate),r.value=e.priority,d.value=e.category})(),i=!1)})),s.addEventListener("click",(function(e){p()})),r.addEventListener("submit",(function(e){e.preventDefault(),(()=>{const e=m(),t=e.category;l.deleteObjectHandler(n.getRelevantTasks(t),e.description,t),a.pushTask("edit-task")})(),r.reset(),p(),(()=>{const e=m(),t=g();if(e.category==u.getTabName()){t.querySelector(".title").textContent=e.title,t.querySelector(".description").textContent=e.description,t.querySelector(".task-date").textContent=e.dueDate;const a=t.querySelector(".priority-indicator").classList;a.remove("low","medium","high"),a.add(e.priority)}else l.deleteTaskCard(t.parentNode,t)})(),i=!0}))}}})(),i=(()=>{const e=e=>{const t=document.querySelector(".display-container"),a=(e=>{const t=d.createDiv("task-container"),a=(e=>{const t=d.createDiv("task-overview","strikethrough"),a=d.createDiv("priority-indicator",e.priority),n=d.createDiv("checkbox","unchecked"),s=d.createPara("title",e.title),r=d.createPara("description",e.description),o=d.createPara("task-date",e.dueDate),i=d.createViewBtn(),c=d.createEditBtn(),l=d.createDeleteBtn();return t.appendChild(a),t.appendChild(n),t.appendChild(s),t.appendChild(r),t.appendChild(o),t.appendChild(i),t.appendChild(c),t.appendChild(l),t})(e);return t.appendChild(a),t})(e),n=a.querySelector(".view-details"),s=a.querySelector(".checkbox");var r;(r=s).addEventListener("click",(function(e){r.parentNode.classList.toggle("strikethrough"),r.classList.toggle("unchecked")})),c.expandDiv(n,a,e),t.appendChild(a)};return{createTaskDetails:e=>{const t=d.createDiv("task-details"),a=d.createPara("task-notes",e.notes);return t.appendChild(a),t},toggleViewDetails:e=>{e.classList.toggle("hide-details")},appendTaskDiv:e,createAllTaskDivs:()=>{const t=u.getTabName();n.getRelevantTasks(t).forEach((t=>{e(t)}))}}})(),c=(()=>{let e={};const t=e=>e.querySelector(".description").textContent,a=a=>e.hasOwnProperty(t(a)),s=a=>e[t(a)],r=a=>{e[t(a)]=!0},d=(e,t)=>{const a=i.createTaskDetails(t);e.appendChild(a)};return{getDivDescription:t,expandDiv:(c,l,u)=>{c.addEventListener("click",(function(g){i.toggleViewDetails(c),((o,i,c)=>{a(o)?a(o)&&s(o)?(o.classList.toggle("expand-task"),(e=>{e.removeChild(e.lastElementChild)})(o),e[t(o)]=!1):a(o)&&!s(o)&&(o.classList.toggle("expand-task"),d(o,c?n.getUpdatedTask():i),r(o)):(o.classList.toggle("expand-task"),d(o,c?n.getUpdatedTask():i),r(o))})(l,u,o.getTaskStatus())}))}}})(),l=(()=>{const t=document.querySelector(".display-container"),a=(e,t,a)=>{const s=e.filter((e=>e.description!==t));n.updateArr(a,s)},s=(e,t)=>{e.removeChild(t)};return{deleteObjectHandler:a,deleteTaskCard:s,removeTaskHandler:()=>{t.addEventListener("click",(function(r){r.target.classList.contains("delete-task")&&(s(t,r.target.parentNode.parentNode),(s=>{const r=c.getDivDescription(s.target.parentNode),d=t.firstElementChild.textContent,o=e.getHyphenatedName(d.toLowerCase());let i=n.getRelevantTasks(o);a(i,r,o)})(r))}))}}})(),u=(()=>{let e="default";const t=()=>e,a=e=>{e.classList.add("active-div")};return{getTabName:t,setThisDivActive:a,tabHandler:()=>{document.querySelector(".expanded-sidebar").addEventListener("click",(function(n){if(n.target.classList.contains("category")){document.querySelectorAll(".category").forEach((e=>{e.classList.remove("active-div")})),a(n.target),s=n.target.id,e=s,d.clearContents();const r=d.createCategoryH1(t());d.appendH1(r),i.createAllTaskDivs()}var s}))}}})(),g=()=>{t.getCategories()&&a.getTasks()||(t.setCategories(),a.setTasks())},p=()=>{const e=t.getCategories();if(e&&e.length>1)for(let t=1;t<e.length;t++)r.appendCategoryDiv(e[t]),d.addExistingOptions(e[t])},m=()=>{const e=document.querySelector("#projects-form");e.addEventListener("submit",(function(t){t.preventDefault();const a=r.getNewCategory();n.checkNewCategoryAdded(s.getCategoryName())&&(s.newCategoryHandler(),r.appendCategoryDiv(a),d.addNewOptionToSelect(a),e.reset(),n.resetCategoryAdded())}))},k=()=>{const e=document.querySelector("#task-form");e.addEventListener("submit",(function(t){t.preventDefault(),s.newTaskHandler(t);const a=u.getTabName(),n=s.getTaskObject("new task");n.category==a&&i.appendTaskDiv(n),e.reset()}))},y=()=>{const e=document.getElementById("default");u.setThisDivActive(e)};(()=>{document.querySelector("#task-due-date").min=(new Date).toISOString().split("T")[0],g(),p(),y(),d.expandCollapseTabs(".sidebar",".expanded-sidebar"),d.expandCollapseTabs("#add-new-task",".task-form-container");const e=d.createCategoryH1(u.getTabName());d.appendH1(e),m(),k(),u.tabHandler(),l.removeTaskHandler(),o.editTaskHandler()})()})();